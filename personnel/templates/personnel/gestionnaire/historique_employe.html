{% extends "base_dashboard.html" %}

{% block dashboard_content %}

<h2>Historique de {{ employe.prenom }} {{ employe.nom }}</h2>

{% if historique %}
<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th>ID</th>
      <th>Véhicule</th>
      <th>Service</th>
      <th>Créneau</th>
      <th>Durée</th>
      <th>Statut</th>
    </tr>
  </thead>
  <tbody>
    {% for r in historique %}
    <tr>
      <td>{{ r.id }}</td>
      <td>{{ r.vehicule.marque }} {{ r.vehicule.modele }} ({{ r.vehicule.plaque_immatric }})</td>
      <td>{{ r.service.nom }}</td>
      <td>{{ r.heure_debut|date:"d/m/Y H:i" }} → {{ r.heure_fin|date:"H:i" }}</td>
      <td>
        {% if r.heure_debut and r.heure_fin %}
          {% with diff=r.heure_fin|timesince:r.heure_debut %}
            {{ diff }}
          {% endwith %}
        {% else %}
          N/A
        {% endif %}
      </td>
      <td>
        <span class="badge bg-{{ r.statut|yesno:'success,warning,secondary,danger' }}">{{ r.get_statut_display }}</span>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
  <p class="text-muted">Aucune activité enregistrée pour cet employé.</p>
{% endif %}

<a href="{% url 'personnel:liste_employes' %}" class="btn btn-outline-secondary mt-3">← Retour</a>
{% endblock %}
